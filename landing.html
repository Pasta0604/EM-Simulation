<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Interactive 3D Electromagnetic Lab Simulator - Learn electromagnetic concepts through visual simulations including bar magnets, solenoids, induction, and more.">
    <title>EM-Verse | Explore Electromagnetism</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="landing.css">
</head>

<body>
    <div id="app" class="portal-container">
        <!-- Header -->
        <header class="portal-header">
            <div class="header-btn glass-button">
                <span class="material-symbols-outlined">account_circle</span>
            </div>

            <div class="header-title">
                <h1 class="header-headline">EM-<span class="accent">Verse</span></h1>
                <p class="subtitle">Dive into EM-Verse, Explore Electromagnetism</p>
            </div>

            <div class="header-btn glass-button">
                <button class="settings-btn">
                    <span class="material-symbols-outlined">settings</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="portal-main">
            <!-- Featured Card -->
            <section class="featured-section">
                <div class="featured-card glass-card">
                    <div class="featured-gradient-overlay"></div>
                    <div class="featured-grid">
                        <div class="featured-image-container">
                            <div class="featured-image"
                                style="background-image: url('assets/images/em-verse-landing.jpg');">
                            </div>
                            <div class="featured-image-gradient"></div>
                            <div class="featured-badge">
                                <span class="pulse-dot"></span>
                                Featured Simulation
                            </div>
                        </div>

                        <div class="featured-content">
                            <span class="featured-label">EM-Verse</span>
                            <h2 class="featured-title">
                                Enter the <br><span class="gradient-text">EM-verse</span>
                            </h2>
                            <p class="featured-description">
                                Explore electromagnetism and observe how the compass needle aligns with field lines in
                                this high-fidelity 3D environment.
                            </p>
                            <div class="featured-actions">
                                <a href="index.html" class="launch-btn glass-button-primary">
                                    <span>LAUNCH SIMULATION</span>
                                    <span class="material-symbols-outlined">rocket_launch</span>
                                </a>
                                <button class="info-btn glass-button">
                                    <span class="material-symbols-outlined">info</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Widget Row -->
            <section class="widgets-section">
                <div class="widget-card glass-card ai-tutor-widget" id="ai-tutor-trigger" onclick="openAITutorModal()">
                    <div class="widget-glow cyan"></div>
                    <div class="widget-content">
                        <div class="widget-header">
                            <div class="widget-icon cyan">
                                <span class="material-symbols-outlined">smart_toy</span>
                            </div>
                            <span class="widget-badge">BETA</span>
                        </div>
                        <div class="widget-body">
                            <h3 class="widget-title cyan">EM-Vee</h3>
                            <p class="widget-description">Stuck on a concept? Get instant answers and formula breakdowns
                                from our specialized AI helper.</p>
                        </div>
                        <button class="widget-action-btn" onclick="event.stopPropagation(); openAITutorModal()">
                            <span>ASK A QUESTION</span>
                        </button>
                    </div>
                </div>

                <div class="widget-card glass-card exam-widget" onclick="openExamPracticeModal()">
                    <div class="widget-glow purple"></div>
                    <div class="widget-content">
                        <div class="widget-header">
                            <div class="widget-icon purple">
                                <span class="material-symbols-outlined">school</span>
                            </div>
                            <div class="mastery-stats">
                                <p class="mastery-label">Mastery</p>
                                <p class="mastery-value">72%</p>
                            </div>
                        </div>
                        <div class="widget-body">
                            <h3 class="widget-title purple">Exam Practice</h3>
                            <div class="progress-container">
                                <div class="progress-info">
                                    <span>WEEKLY GOAL</span>
                                    <span>15/20 Qs</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 75%;"></div>
                                </div>
                            </div>
                        </div>
                        <button class="widget-action-btn purple"
                            onclick="event.stopPropagation(); openExamPracticeModal()">
                            <span>TAKE PRACTICE TEST</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- What is Electromagnetism Section -->
            <section class="em-intro-section">
                <div class="section-header">
                    <div class="section-title">
                        <span class="title-accent"></span>
                        What is Electromagnetism?
                    </div>
                </div>
                <div class="em-intro-card glass-card">
                    <div class="em-intro-header">
                        <div class="em-badge">
                            <span class="pulse-dot"></span>
                            The Core Foundation
                        </div>
                        <h2 class="em-intro-title">
                            What is <br><span class="gradient-text">Electromagnetism,</span><br> really?
                        </h2>
                        <p class="em-intro-description">
                            Beyond the formulas lies the pulse of reality. Master the force that powers the universe.
                        </p>
                    </div>
                    <div class="em-features">
                        <a href="syllabus.html" class="em-feature-item">
                            <div class="em-feature-icon cyan">
                                <span class="material-symbols-outlined">public</span>
                            </div>
                            <div class="em-feature-content">
                                <h3 class="em-feature-title cyan">Universal Force</h3>
                                <p class="em-feature-description">It governs everything from the spin of subatomic
                                    particles to the gravity-defying drift of galaxies.</p>
                            </div>
                        </a>
                        <div class="em-feature-item">
                            <div class="em-feature-icon purple">
                                <span class="material-symbols-outlined">settings_input_component</span>
                            </div>
                            <div class="em-feature-content">
                                <h3 class="em-feature-title purple">Engineering Power</h3>
                                <p class="em-feature-description">The ultimate bridge between abstract physics and the
                                    circuit boards in your pocket.</p>
                            </div>
                        </div>
                        <div class="em-feature-item">
                            <div class="em-feature-icon white">
                                <span class="material-symbols-outlined">psychology</span>
                            </div>
                            <div class="em-feature-content">
                                <h3 class="em-feature-title">Cognitive Leap</h3>
                                <p class="em-feature-description">Mastering these fields rewires your brain to solve
                                    complex problems with unprecedented clarity.</p>
                            </div>
                        </div>
                        <div class="em-feature-item">
                            <div class="em-feature-icon red">
                                <span class="material-symbols-outlined">bolt</span>
                            </div>
                            <div class="em-feature-content">
                                <h3 class="em-feature-title red">Formula to Tech</h3>
                                <p class="em-feature-description">Move past the textbook. Learn how a single Maxwell
                                    equation becomes a global communications network.</p>
                            </div>
                        </div>
                    </div>
                    <a href="history.html" class="em-cta-btn glass-button-primary">
                        <span>Start the Journey</span>
                        <span class="material-symbols-outlined">rocket_launch</span>
                    </a>
                </div>
            </section>

            <!-- Core Modules Section -->
            <section class="core-modules-section">
                <div class="section-header">
                    <div class="section-title">
                        <span class="title-accent"></span>
                        Explore More
                    </div>
                </div>
                <div class="core-modules-grid">
                    <!-- History & Foundations Card -->
                    <a href="history.html" class="module-feature-card">
                        <div class="module-card-image"
                            style="background-image: url('assets/images/history-card-bg.png');"></div>
                        <div class="module-card-gradient"></div>
                        <div class="module-card-content">
                            <div class="module-card-badge cyan">
                                <span class="material-symbols-outlined">auto_awesome</span>
                                <span>HISTORY & FOUNDATIONS</span>
                            </div>
                            <h3 class="module-card-title">THE ARCHITECTS OF LIGHT</h3>
                            <p class="module-card-description">Journey through the origins of electromagnetic theory.
                                Master Maxwell's equations and the brilliant minds that defined the speed of light.</p>
                        </div>
                    </a>

                    <!-- Student Support Card -->
                    <a href="syllabus.html" class="module-feature-card">
                        <div class="module-card-image"
                            style="background-image: url('assets/images/physics-card-bg.png');"></div>
                        <div class="module-card-gradient"></div>
                        <div class="module-card-content">
                            <div class="module-card-badge green">
                                <span class="material-symbols-outlined">school</span>
                                <span>STUDENT SUPPORT</span>
                            </div>
                            <h3 class="module-card-title">PHYSICS WITHOUT CRYING</h3>
                            <p class="module-card-description">Our signature empathetic support module. Designed to
                                bridge the gap between complex vector calculus and intuitive physical understanding.</p>
                        </div>
                    </a>

                    <!-- Modern Tech Card -->
                    <a href="applications.html" class="module-feature-card">
                        <div class="module-card-image"
                            style="background-image: url('assets/images/modern-tech-bg.png');"></div>
                        <div class="module-card-gradient"></div>
                        <div class="module-card-content">
                            <div class="module-card-badge magenta">
                                <span class="material-symbols-outlined">rocket_launch</span>
                                <span>MODERN TECH</span>
                            </div>
                            <h3 class="module-card-title">EM IN TODAY'S WORLD</h3>
                            <p class="module-card-description">From 5G networks to wireless charging and fiber optics.
                                Explore the real-world applications driving the future of communication.</p>
                        </div>
                    </a>
                </div>
            </section>

        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-container glass-nav">
                <div class="nav-item active">
                    <span class="material-symbols-outlined filled">home</span>
                    <span class="nav-label">HOME</span>
                </div>

                <a href="history.html" class="nav-item">
                    <span class="material-symbols-outlined">history_edu</span>
                    <span class="nav-label">HISTORY</span>
                </a>

                <div class="nav-search">
                    <a href="index.html" class="search-btn">
                        <span class="material-symbols-outlined">grid_view</span>
                    </a>
                </div>

                <a href="syllabus.html" class="nav-item">
                    <span class="material-symbols-outlined">menu_book</span>
                    <span class="nav-label">LEARN</span>
                </a>

                <a href="applications.html" class="nav-item">
                    <span class="material-symbols-outlined">explore</span>
                    <span class="nav-label">EXPLORE</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- EM-Vee Modal -->
    <div id="ai-tutor-modal" class="modal-overlay" onclick="closeAITutorModal(event)">
        <div class="modal-container glass-card" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title-area">
                    <div class="widget-icon cyan">
                        <span class="material-symbols-outlined">smart_toy</span>
                    </div>
                    <div>
                        <h2 class="modal-title">EM-Vee</h2>
                        <p class="modal-subtitle">Powered by Gemini AI</p>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="closeAITutorModal(event)">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="chat-container" id="ai-chat-container">
                    <div class="chat-welcome">
                        <span class="material-symbols-outlined chat-icon">psychology</span>
                        <h3>Welcome to EM-Vee!</h3>
                        <p>Ask me anything about electromagnetism, from basic concepts to complex problems.</p>
                    </div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="ai-chat-input" placeholder="Ask a question about electromagnetism..."
                        onkeypress="if(event.key==='Enter') sendAIMessage()">
                    <button class="send-btn" onclick="sendAIMessage()">
                        <span class="material-symbols-outlined">send</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Exam Practice Modal -->
    <div id="exam-practice-modal" class="modal-overlay" onclick="closeExamPracticeModal(event)">
        <div class="modal-container glass-card exam-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title-area">
                    <div class="widget-icon purple">
                        <span class="material-symbols-outlined">school</span>
                    </div>
                    <div>
                        <h2 class="modal-title">Exam Practice</h2>
                        <p class="modal-subtitle">Test your EM knowledge</p>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="closeExamPracticeModal(event)">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="modal-body exam-body">
                <div class="exam-question-area" id="exam-question-area">
                    <div class="exam-welcome">
                        <span class="material-symbols-outlined exam-icon">quiz</span>
                        <h3>Ready to Practice?</h3>
                        <p>Challenge yourself with electromagnetism questions to test your understanding.</p>
                        <button class="start-exam-btn glass-button-primary" onclick="startExamPractice()">
                            <span>START PRACTICE</span>
                            <span class="material-symbols-outlined">play_arrow</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Puzzle Intro Modal (for Launch Simulation) -->
    <div id="puzzle-intro-modal" class="modal-overlay" onclick="closePuzzleModal(event)">
        <div class="modal-container glass-card puzzle-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title-area">
                    <div class="widget-icon cyan">
                        <span class="material-symbols-outlined">extension</span>
                    </div>
                    <div>
                        <h2 class="modal-title">Welcome to EM-Verse!</h2>
                        <p class="modal-subtitle">Build to understand</p>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="closePuzzleModal(event)">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="modal-body puzzle-body">
                <div class="puzzle-intro-content">
                    <div class="puzzle-icon-large">
                        <span class="material-symbols-outlined">toys_and_games</span>
                    </div>
                    <h3>Start with the Bar Magnet Puzzle</h3>
                    <p>Before diving into the simulations, we recommend completing the Assembly Puzzle to understand how
                        a bar magnet works from the ground up.</p>

                    <div class="puzzle-buttons">
                        <a href="index.html#assembly" class="puzzle-start-btn glass-button-primary">
                            <span class="material-symbols-outlined">extension</span>
                            <span>START PUZZLE</span>
                        </a>
                        <a href="index.html#barMagnet" class="puzzle-skip-btn glass-button">
                            <span>Skip & Explore</span>
                            <span class="material-symbols-outlined">arrow_forward</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal Functions
        function openAITutorModal() {
            document.getElementById('ai-tutor-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeAITutorModal(event) {
            if (event) event.stopPropagation();
            document.getElementById('ai-tutor-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function openExamPracticeModal() {
            document.getElementById('exam-practice-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeExamPracticeModal(event) {
            if (event) event.stopPropagation();
            document.getElementById('exam-practice-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function openPuzzleModal() {
            document.getElementById('puzzle-intro-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closePuzzleModal(event) {
            if (event) event.stopPropagation();
            document.getElementById('puzzle-intro-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // EM-Vee chat placeholder
        function sendAIMessage() {
            const input = document.getElementById('ai-chat-input');
            const message = input.value.trim();
            if (!message) return;

            const container = document.getElementById('ai-chat-container');
            // Clear welcome if present
            const welcome = container.querySelector('.chat-welcome');
            if (welcome) welcome.remove();

            // Add user message
            container.innerHTML += `<div class="chat-message user"><p>${message}</p></div>`;

            // Add AI response placeholder
            container.innerHTML += `<div class="chat-message ai"><p>EM-Vee is here to help! Ask me anything about electromagnetism.</p></div>`;

            input.value = '';
            container.scrollTop = container.scrollHeight;
        }

        // Exam Practice - Full Question Bank
        const examQuestions = [
            {
                id: 1,
                scenario: "A generator coil rotates through one-fourth of a revolution (Œ∏=0¬∞ to Œ∏=90¬∞) in 15 ms.",
                data: "Turns (N) = 200, Radius (r) = 5.00 cm, Magnetic Field (B) = 1.25 T",
                question: "What is the magnitude of the induced EMF?",
                options: ["65.5 V", "131 V", "262 V", "98 V"],
                correct: 1,
                explanation: "Using Œµ = -NBA(Œîcos Œ∏/Œît) = -200(1.25)(œÄ√ó0.05¬≤)((cos90¬∞ - cos0¬∞)/(15√ó10‚Åª¬≥)) = 131 V"
            },
            {
                id: 2,
                scenario: "A coil with self-inductance L = 5.0 H is connected in series with a switch to a 12V battery. Total resistance R = 6.0 Œ©.",
                data: "L = 5.0 H, V = 12 V, R = 6.0 Œ©",
                question: "What is the rate of growth of current (dI/dt) when the switch is first closed?",
                options: ["1.2 A/s", "2.4 A/s", "4.8 A/s", "0.6 A/s"],
                correct: 1,
                explanation: "At t=0, current I=0. Back EMF = -V. So -L(dI/dt) = -12, therefore dI/dt = 12/5 = 2.4 A/s"
            },
            {
                id: 3,
                scenario: "Using the same circuit (L=5.0H, V=12V, R=6.0Œ©), when current reaches maximum:",
                data: "L = 5.0 H, V = 12 V, R = 6.0 Œ©",
                question: "What is the energy stored in the inductor at maximum current?",
                options: ["5 J", "10 J", "20 J", "2.5 J"],
                correct: 1,
                explanation: "Maximum current I = V/R = 12/6 = 2A. Energy E = ¬ΩLI¬≤ = 0.5 √ó 5 √ó (2¬≤) = 10 J"
            },
            {
                id: 4,
                scenario: "A bar magnet (North pole facing solenoid) is moved away from a solenoid connected to a galvanometer.",
                data: "Magnet moving away, N-pole facing solenoid",
                question: "According to Lenz's Law, what happens at the solenoid end facing the magnet?",
                options: [
                    "It becomes a North pole to repel the magnet",
                    "It becomes a South pole to attract the magnet",
                    "No magnetic pole is induced",
                    "It alternates between N and S poles"
                ],
                correct: 1,
                explanation: "According to Lenz's Law, the induced current opposes the change. To attract the retreating North pole, the solenoid end becomes a South pole."
            },
            {
                id: 5,
                scenario: "A small coil (N=150, Area=1.0 cm¬≤) is inside a patient's chest. A large external coil (N=500, r=10cm, R=10Œ©) is connected to a 60V battery (internal resistance 10Œ©). Current drops to zero in 10‚Åª‚Å¥ s.",
                data: "Small coil: N=150, A=10‚Åª‚Å¥ m¬≤. Large coil: N=500, r=0.1m. Battery: 60V, r=10Œ©. Œît=10‚Åª‚Å¥s",
                question: "Why is the induced EMF larger when switching OFF compared to switching ON?",
                options: [
                    "The magnetic field is stronger when OFF",
                    "The time for current change is much shorter when switching OFF, increasing dŒ¶/dt",
                    "The coil has more turns when OFF",
                    "The resistance decreases when OFF"
                ],
                correct: 1,
                explanation: "When switching OFF, current drops to zero very rapidly (short Œît). Since EMF ‚àù dŒ¶/dt, the shorter time during OFF results in much larger induced EMF."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        function startExamPractice() {
            currentQuestion = 0;
            score = 0;
            showQuestion();
        }

        function showQuestion() {
            const area = document.getElementById('exam-question-area');
            const q = examQuestions[currentQuestion];
            answered = false;

            area.innerHTML = `
                <div class="exam-question fade-in">
                    <div class="question-header">
                        <span class="question-number">Question ${q.id} of ${examQuestions.length}</span>
                        <span class="score-display">Score: ${score}/${currentQuestion}</span>
                    </div>
                    <div class="scenario-box">
                        <p class="scenario-label">üìã Scenario</p>
                        <p class="scenario-text">${q.scenario}</p>
                        <p class="data-text"><strong>Given:</strong> ${q.data}</p>
                    </div>
                    <h3 class="question-text">${q.question}</h3>
                    <div class="answer-options">
                        ${q.options.map((opt, idx) => `
                            <button class="answer-btn" data-index="${idx}" onclick="selectExamAnswer(${idx})">
                                <span class="option-letter">${String.fromCharCode(65 + idx)}</span>
                                <span class="option-text">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                    <div id="feedback-area"></div>
                    <div class="exam-actions">
                        <button id="next-btn" class="next-question-btn glass-button" style="display:none;" onclick="nextQuestion()">
                            ${currentQuestion < examQuestions.length - 1 ? 'Next Question' : 'See Results'}
                            <span class="material-symbols-outlined">arrow_forward</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function selectExamAnswer(selectedIdx) {
            if (answered) return;
            answered = true;

            const q = examQuestions[currentQuestion];
            const buttons = document.querySelectorAll('.answer-btn');
            const feedbackArea = document.getElementById('feedback-area');
            const nextBtn = document.getElementById('next-btn');

            buttons.forEach((btn, idx) => {
                btn.disabled = true;
                if (idx === q.correct) {
                    btn.classList.add('correct');
                } else if (idx === selectedIdx) {
                    btn.classList.add('incorrect');
                }
            });

            if (selectedIdx === q.correct) {
                score++;
                feedbackArea.innerHTML = `
                    <div class="feedback correct">
                        <span class="material-symbols-outlined">check_circle</span>
                        <div>
                            <strong>Correct!</strong>
                            <p>${q.explanation}</p>
                        </div>
                    </div>
                `;
            } else {
                feedbackArea.innerHTML = `
                    <div class="feedback incorrect">
                        <span class="material-symbols-outlined">cancel</span>
                        <div>
                            <strong>Incorrect</strong>
                            <p>${q.explanation}</p>
                        </div>
                    </div>
                `;
            }

            nextBtn.style.display = 'flex';
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < examQuestions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            const area = document.getElementById('exam-question-area');
            const percentage = Math.round((score / examQuestions.length) * 100);
            let message = '';
            let emoji = '';

            if (percentage >= 80) {
                message = 'Excellent! You have a strong grasp of Electromagnetic Induction!';
                emoji = 'üèÜ';
            } else if (percentage >= 60) {
                message = 'Good job! Review the concepts you missed and try again.';
                emoji = 'üëç';
            } else {
                message = 'Keep studying! Review the electromagnetic induction principles and try again.';
                emoji = 'üìö';
            }

            area.innerHTML = `
                <div class="exam-results fade-in">
                    <div class="results-emoji">${emoji}</div>
                    <h3>Practice Complete!</h3>
                    <div class="results-score">
                        <span class="score-big">${score}</span>
                        <span class="score-divider">/</span>
                        <span class="score-total">${examQuestions.length}</span>
                    </div>
                    <p class="score-percentage">${percentage}% Correct</p>
                    <p class="results-message">${message}</p>
                    <div class="results-actions">
                        <button class="retry-btn glass-button-primary" onclick="startExamPractice()">
                            <span class="material-symbols-outlined">replay</span>
                            <span>Try Again</span>
                        </button>
                        <button class="close-btn glass-button" onclick="closeExamPracticeModal()">
                            <span>Close</span>
                        </button>
                    </div>
                </div>
            `;
        }

        // Handle module card clicks
        document.querySelectorAll('.module-card').forEach(card => {
            card.addEventListener('click', (e) => {
                if (e.target.closest('a')) return;
                const module = card.dataset.module;
                window.location.href = `index.html#${module}`;
            });
        });

        // Handle featured card / Launch Simulation - show puzzle intro modal
        document.querySelector('.launch-btn').addEventListener('click', (e) => {
            e.preventDefault();
            openPuzzleModal();
        });

        document.querySelector('.featured-card').addEventListener('click', (e) => {
            if (e.target.closest('a') || e.target.closest('button')) return;
            openPuzzleModal();
        });

        // Material symbols filled for active state
        document.querySelectorAll('.material-symbols-outlined.filled').forEach(icon => {
            icon.style.fontVariationSettings = "'FILL' 1, 'wght' 300, 'GRAD' 0, 'opsz' 24";
        });

        // Close modals on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAITutorModal();
                closeExamPracticeModal();
                closePuzzleModal();
            }
        });

        // Fade-in animation on page load
        document.addEventListener('DOMContentLoaded', () => {
            const fadeElements = document.querySelectorAll('.featured-section, .widgets-section, .em-intro-section, .core-modules-section, .portal-header');
            fadeElements.forEach((el, idx) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, 100 + (idx * 150));
            });
        });
    </script>

    <!-- EM-Vee Floating Button (same as index.html) -->
    <script type="module">
        import { GeminiTutor } from './js/GeminiTutor.js';

        // Initialize EM-Vee on the landing page
        document.addEventListener('DOMContentLoaded', () => {
            // Create a minimal app object for the tutor
            const tutorApp = {
                currentModule: { name: 'landing' }
            };

            // Initialize Gemini Tutor
            window.geminiTutor = new GeminiTutor(tutorApp);
        });
    </script>
</body>

</html>